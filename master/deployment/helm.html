<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/node-feature-discovery/master/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/node-feature-discovery/master/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(3)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(3) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(3) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(3) > ul.nav-list { display: block; } </style> <script src="/node-feature-discovery/master/assets/js/vendor/lunr.min.js"></script> <script src="/node-feature-discovery/master/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Helm | Node Feature Discovery</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Helm" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documentation of Node Feature Discovery - a Kubernetes add-on for discovering and advertising hardware features and system configuration in the cluster." /> <meta property="og:description" content="Documentation of Node Feature Discovery - a Kubernetes add-on for discovering and advertising hardware features and system configuration in the cluster." /> <link rel="canonical" href="https://kubernetes-sigs.github.com/node-feature-discovery/master/deployment/helm.html" /> <meta property="og:url" content="https://kubernetes-sigs.github.com/node-feature-discovery/master/deployment/helm.html" /> <meta property="og:site_name" content="Node Feature Discovery" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Helm" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Documentation of Node Feature Discovery - a Kubernetes add-on for discovering and advertising hardware features and system configuration in the cluster.","headline":"Helm","url":"https://kubernetes-sigs.github.com/node-feature-discovery/master/deployment/helm.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/node-feature-discovery/master/" class="site-title lh-tight"> Node Feature Discovery </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Get started category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/node-feature-discovery/master/get-started/" class="nav-list-link">Get started</a><ul class="nav-list"><li class="nav-list-item"><a href="/node-feature-discovery/master/get-started/introduction.html" class="nav-list-link">Introduction</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/get-started/quick-start.html" class="nav-list-link">Quick start</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Deployment category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/node-feature-discovery/master/deployment/" class="nav-list-link">Deployment</a><ul class="nav-list"><li class="nav-list-item"><a href="/node-feature-discovery/master/deployment/image-variants.html" class="nav-list-link">Image variants</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/deployment/kustomize.html" class="nav-list-link">Kustomize</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/deployment/helm.html" class="nav-list-link">Helm</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/deployment/operator.html" class="nav-list-link">NFD Operator</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/deployment/uninstallation.html" class="nav-list-link">Uninstallation</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/deployment/metrics.html" class="nav-list-link">Metrics</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Usage category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/node-feature-discovery/master/usage/" class="nav-list-link">Usage</a><ul class="nav-list"><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/features.html" class="nav-list-link">Feature labels</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/using-labels.html" class="nav-list-link">Using node labels</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/nfd-master.html" class="nav-list-link">NFD-Master</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/nfd-worker.html" class="nav-list-link">NFD-Worker</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/nfd-topology-updater.html" class="nav-list-link">NFD-Topology-Updater</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/nfd-gc.html" class="nav-list-link">NFD-Garbage-Collector</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/custom-resources.html" class="nav-list-link">CRDs</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/customization-guide.html" class="nav-list-link">Customization guide</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/examples-and-demos.html" class="nav-list-link">Examples and demos</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/kubectl-plugin.html" class="nav-list-link">Kubectl plugin</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/usage/image-compatibility.html" class="nav-list-link">Image Compatibility Artifact</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Reference category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/node-feature-discovery/master/reference/" class="nav-list-link">Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/master-commandline-reference.html" class="nav-list-link">Master cmdline reference</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/worker-commandline-reference.html" class="nav-list-link">Worker cmdline reference</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/master-configuration-reference.html" class="nav-list-link">Master config reference</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/worker-configuration-reference.html" class="nav-list-link">Worker config reference</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/topology-updater-commandline-reference.html" class="nav-list-link">Topology Updater Cmdline Reference</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/topology-updater-configuration-reference.html" class="nav-list-link">Topology-Updater config reference</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/gc-commandline-reference.html" class="nav-list-link">Garbage Collector Cmdline Reference</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/plugin-commandline-reference.html" class="nav-list-link">Kubectl plugin cmdline reference</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/node-feature-client-reference.html" class="nav-list-link">Node Feature client cmdline reference</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/versions.html" class="nav-list-link">Versions</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/reference/feature-gates.html" class="nav-list-link">Feature Gates</a></li></ul></li><li class="nav-list-item"><a href="/node-feature-discovery/master/developer-guide/" class="nav-list-link">Developer guide</a></li><li class="nav-list-item"><a href="/node-feature-discovery/master/contributing/" class="nav-list-link">Contributing</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Node Feature Discovery" aria-label="Search Node Feature Discovery" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <div class="version-menu"> <label for="versions">Version:</label> <select id="versions" onchange="location = this.value;"> <script src="/node-feature-discovery/versions.js"></script> <script> var select = document.getElementById('versions'); var items = getVersionListItems(); for (var i=0; i < items.length; i++) { var opt = document.createElement('option'); opt.appendChild(document.createTextNode(items[i].name)); opt.value = items[i].url; select.appendChild(opt); } </script> </select> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/node-feature-discovery/master/deployment/">Deployment</a></li> <li class="breadcrumb-nav-list-item"><span>Helm</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="deployment-with-helm"> <a href="#deployment-with-helm" class="anchor-heading" aria-labelledby="deployment-with-helm"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deployment with Helm </h1> <h2 class="no_toc" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol class="no_toc text-delta" id="markdown-toc"> <li><a href="#deployment-with-helm" id="markdown-toc-deployment-with-helm">Deployment with Helm</a> <ol> <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li> <li><a href="#deployment" id="markdown-toc-deployment">Deployment</a></li> <li><a href="#configuration" id="markdown-toc-configuration">Configuration</a></li> <li><a href="#upgrading-the-chart" id="markdown-toc-upgrading-the-chart">Upgrading the chart</a> <ol> <li><a href="#from-v07-and-older" id="markdown-toc-from-v07-and-older">From v0.7 and older</a></li> <li><a href="#from-v08---v011" id="markdown-toc-from-v08---v011">From v0.8 - v0.11</a></li> <li><a href="#from-v012---v013" id="markdown-toc-from-v012---v013">From v0.12 - v0.13</a></li> <li><a href="#from-v014" id="markdown-toc-from-v014">From v0.14+</a></li> </ol> </li> <li><a href="#uninstalling-the-chart" id="markdown-toc-uninstalling-the-chart">Uninstalling the chart</a></li> <li><a href="#chart-parameters" id="markdown-toc-chart-parameters">Chart parameters</a> <ol> <li><a href="#general-parameters" id="markdown-toc-general-parameters">General parameters</a></li> <li><a href="#master-pod-parameters" id="markdown-toc-master-pod-parameters">Master pod parameters</a></li> <li><a href="#worker-pod-parameters" id="markdown-toc-worker-pod-parameters">Worker pod parameters</a></li> <li><a href="#topology-updater-parameters" id="markdown-toc-topology-updater-parameters">Topology updater parameters</a></li> <li><a href="#garbage-collector-parameters" id="markdown-toc-garbage-collector-parameters">Garbage collector parameters</a></li> </ol> </li> </ol> </li> </ol><hr /> <p>Node Feature Discovery provides a Helm chart to manage its deployment.</p> <blockquote> <p><strong>NOTE:</strong> NFD is not ideal for other Helm charts to depend on as that may result in multiple parallel NFD deployments in the same cluster which is not fully supported by the NFD Helm chart.</p> </blockquote> <h2 id="prerequisites"> <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites </h2> <p><a href="https://helm.sh/">Helm package manager</a> should be installed.</p> <h2 id="deployment"> <a href="#deployment" class="anchor-heading" aria-labelledby="deployment"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deployment </h2> <p>To install the latest stable version:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">NFD_NS</span><span class="o">=</span>node-feature-discovery
helm repo add nfd https://kubernetes-sigs.github.io/node-feature-discovery/charts
helm repo update
helm <span class="nb">install </span>nfd/node-feature-discovery <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span> <span class="nt">--create-namespace</span> <span class="nt">--generate-name</span>
</code></pre></div></div> <p>To install the latest development version you need to clone the NFD Git repository and install from there.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/kubernetes-sigs/node-feature-discovery/
<span class="nb">cd </span>node-feature-discovery/deployment/helm
<span class="nb">export </span><span class="nv">NFD_NS</span><span class="o">=</span>node-feature-discovery
helm <span class="nb">install </span>node-feature-discovery ./node-feature-discovery/ <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span> <span class="nt">--create-namespace</span>
</code></pre></div></div> <p>See the <a href="#configuration">configuration</a> section below for instructions how to alter the deployment parameters.</p> <h2 id="configuration"> <a href="#configuration" class="anchor-heading" aria-labelledby="configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuration </h2> <p>You can override values from <code class="language-plaintext highlighter-rouge">values.yaml</code> and provide a file with custom values:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">NFD_NS</span><span class="o">=</span>node-feature-discovery
helm <span class="nb">install </span>nfd/node-feature-discovery <span class="nt">-f</span> &lt;path/to/custom/values.yaml&gt; <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span> <span class="nt">--create-namespace</span>
</code></pre></div></div> <p>To specify each parameter separately you can provide them to helm install command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">NFD_NS</span><span class="o">=</span>node-feature-discovery
helm <span class="nb">install </span>nfd/node-feature-discovery <span class="nt">--set</span> <span class="nv">nameOverride</span><span class="o">=</span>NFDinstance <span class="nt">--set</span> master.replicaCount<span class="o">=</span>2 <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span> <span class="nt">--create-namespace</span>
</code></pre></div></div> <h2 id="upgrading-the-chart"> <a href="#upgrading-the-chart" class="anchor-heading" aria-labelledby="upgrading-the-chart"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Upgrading the chart </h2> <p>To upgrade the <code class="language-plaintext highlighter-rouge">node-feature-discovery</code> deployment to master via Helm.</p> <h3 id="from-v07-and-older"> <a href="#from-v07-and-older" class="anchor-heading" aria-labelledby="from-v07-and-older"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> From v0.7 and older </h3> <p>Please see the <a href="https://kubernetes-sigs.github.io/node-feature-discovery/v0.7/get-started/deployment-and-usage.html#uninstallation">uninstallation guide</a>. And then follow the standard <a href="#deployment">deployment instructions</a>.</p> <h3 id="from-v08---v011"> <a href="#from-v08---v011" class="anchor-heading" aria-labelledby="from-v08---v011"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> From v0.8 - v0.11 </h3> <p>Helm deployment of NFD was introduced in v0.8.0.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">NFD_NS</span><span class="o">=</span>node-feature-discovery
<span class="c"># Uninstall the old NFD deployment</span>
helm uninstall node-feature-discovery <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span>
<span class="c"># Update Helm repository</span>
helm repo update
<span class="c"># Install the new NFD deployment</span>
helm upgrade <span class="nt">--install</span> node-feature-discovery nfd/node-feature-discovery <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span> <span class="nt">--set</span> master.enable<span class="o">=</span><span class="nb">false</span>
<span class="c"># Wait for NFD Worker to be ready</span>
kubectl <span class="nb">wait</span> <span class="nt">--timeout</span><span class="o">=</span><span class="nt">-1s</span> <span class="nt">--for</span><span class="o">=</span><span class="nv">condition</span><span class="o">=</span>ready pod <span class="nt">-l</span> app.kubernetes.io/name<span class="o">=</span>node-feature-discovery <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span>
<span class="c"># Enable the NFD Master</span>
helm upgrade <span class="nt">--install</span> node-feature-discovery nfd/node-feature-discovery <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span> <span class="nt">--set</span> master.enable<span class="o">=</span><span class="nb">true</span>
</code></pre></div></div> <h3 id="from-v012---v013"> <a href="#from-v012---v013" class="anchor-heading" aria-labelledby="from-v012---v013"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> From v0.12 - v0.13 </h3> <p>In v0.12 the <code class="language-plaintext highlighter-rouge">NodeFeature</code> CRD was introduced as experimental. The API was not enabled by default.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">NFD_NS</span><span class="o">=</span>node-feature-discovery
<span class="c"># Update Helm repository</span>
helm repo update
<span class="c"># Install and upgrade CRD's</span>
kubectl apply <span class="nt">-f</span> https://raw.githubusercontent.com/kubernetes-sigs/node-feature-discovery/master/deployment/base/nfd-crds/nfd-api-crds.yaml
<span class="c"># Install the new NFD deployment</span>
helm upgrade node-feature-discovery nfd/node-feature-discovery <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span> <span class="nt">--set</span> master.enable<span class="o">=</span><span class="nb">false</span>
<span class="c"># Wait for NFD Worker to be ready</span>
kubectl <span class="nb">wait</span> <span class="nt">--timeout</span><span class="o">=</span><span class="nt">-1s</span> <span class="nt">--for</span><span class="o">=</span><span class="nv">condition</span><span class="o">=</span>ready pod <span class="nt">-l</span> app.kubernetes.io/name<span class="o">=</span>node-feature-discovery <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span>
<span class="c"># Enable the NFD Master</span>
helm upgrade node-feature-discovery nfd/node-feature-discovery <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span> <span class="nt">--set</span> master.enable<span class="o">=</span><span class="nb">true</span>
</code></pre></div></div> <h3 id="from-v014"> <a href="#from-v014" class="anchor-heading" aria-labelledby="from-v014"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> From v0.14+ </h3> <p>As of version v0.14 the Helm chart is the primary deployment method for NFD, and the CRD <code class="language-plaintext highlighter-rouge">NodeFeature</code> is enabled by default.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">NFD_NS</span><span class="o">=</span>node-feature-discovery
<span class="c"># Update Helm repository</span>
helm repo update
<span class="c"># Install and upgrade CRD's</span>
kubectl apply <span class="nt">-f</span> https://raw.githubusercontent.com/kubernetes-sigs/node-feature-discovery/master/deployment/base/nfd-crds/nfd-api-crds.yaml
<span class="c"># Install the new NFD deployment</span>
helm upgrade node-feature-discovery nfd/node-feature-discovery <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span>
</code></pre></div></div> <h2 id="uninstalling-the-chart"> <a href="#uninstalling-the-chart" class="anchor-heading" aria-labelledby="uninstalling-the-chart"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Uninstalling the chart </h2> <p>To uninstall the <code class="language-plaintext highlighter-rouge">node-feature-discovery</code> deployment:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">NFD_NS</span><span class="o">=</span>node-feature-discovery
helm uninstall node-feature-discovery <span class="nt">--namespace</span> <span class="nv">$NFD_NS</span>
</code></pre></div></div> <p>The command removes all the Kubernetes components associated with the chart and deletes the release. It also runs a post-delete hook that cleans up the nodes of all labels, annotations, taints and extended resources that were created by NFD.</p> <h2 id="chart-parameters"> <a href="#chart-parameters" class="anchor-heading" aria-labelledby="chart-parameters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Chart parameters </h2> <p>To tailor the deployment of the Node Feature Discovery to your needs following Chart parameters are available.</p> <h3 id="general-parameters"> <a href="#general-parameters" class="anchor-heading" aria-labelledby="general-parameters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> General parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">image.repository</code></td> <td>string</td> <td><code class="language-plaintext highlighter-rouge">gcr.io/k8s-staging-nfd/node-feature-discovery</code></td> <td>NFD image repository</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">image.tag</code></td> <td>string</td> <td><code class="language-plaintext highlighter-rouge">master</code></td> <td>NFD image tag</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">image.pullPolicy</code></td> <td>string</td> <td><code class="language-plaintext highlighter-rouge">Always</code></td> <td>Image pull policy</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">imagePullSecrets</code></td> <td>array</td> <td>[]</td> <td>ImagePullSecrets is an optional list of references to secrets in the same namespace to use for pulling any of the images used by this PodSpec. <a href="https://kubernetes.io/docs/concepts/containers/images#specifying-imagepullsecrets-on-a-pod">More info</a>.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">nameOverride</code></td> <td>string</td> <td> </td> <td>Override the name of the chart</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">fullnameOverride</code></td> <td>string</td> <td> </td> <td>Override a default fully qualified app name</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">featureGates.NodeFeatureGroupAPI</code></td> <td>bool</td> <td>false</td> <td>Enable the <a href="/node-feature-discovery/master/usage/custom-resources.html#nodefeaturegroup">NodeFeatureGroup</a> CRD API.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">featureGates.DisableAutoPrefix</code></td> <td>bool</td> <td>false</td> <td>Enable <a href="/node-feature-discovery/master/reference/feature-gates.html#disableautoprefix">DisableAutoPrefix</a> feature gate. Disables automatic prefixing of unprefixed labels, annotations and extended resources.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">prometheus.enable</code></td> <td>bool</td> <td>false</td> <td>Specifies whether to expose metrics using prometheus operator</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">prometheus.labels</code></td> <td>dict</td> <td>{}</td> <td>Specifies labels for use with the prometheus operator to control how it is selected</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">prometheus.scrapeInterval</code></td> <td>string</td> <td>10s</td> <td>Specifies the interval by which metrics are scraped</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">priorityClassName</code></td> <td>string</td> <td> </td> <td>The name of the PriorityClass to be used for the NFD pods.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">postDeleteCleanup</code></td> <td>bool</td> <td>true</td> <td>Controls behavior of post-delete hook.</td> </tr> </tbody> </table></div> <p>Metrics are configured to be exposed using prometheus operator API’s by default. If you want to expose metrics using the prometheus operator API’s you need to install the prometheus operator in your cluster.</p> <h3 id="master-pod-parameters"> <a href="#master-pod-parameters" class="anchor-heading" aria-labelledby="master-pod-parameters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Master pod parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">master.*</code></td> <td>dict</td> <td> </td> <td>NFD master deployment configuration</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.enable</code></td> <td>bool</td> <td>true</td> <td>Specifies whether nfd-master should be deployed</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.hostNetwork</code></td> <td>bool</td> <td>false</td> <td>Specifies whether to enable or disable running the container in the host’s network namespace</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.port</code></td> <td>integer</td> <td>8080</td> <td>Port on which to serve http for metrics and healthz endpoints.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.instance</code></td> <td>string</td> <td> </td> <td>Instance name. Used to separate annotation namespaces for multiple parallel deployments</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.resyncPeriod</code></td> <td>string</td> <td> </td> <td>NFD API controller resync period.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.extraLabelNs</code></td> <td>array</td> <td>[]</td> <td>List of allowed extra label namespaces</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.enableTaints</code></td> <td>bool</td> <td>false</td> <td>Specifies whether to enable or disable node tainting</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.replicaCount</code></td> <td>integer</td> <td>1</td> <td>Number of desired pods. This is a pointer to distinguish between explicit zero and not specified</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.podSecurityContext</code></td> <td>dict</td> <td>{}</td> <td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod">PodSecurityContext</a> holds pod-level security attributes and common container settings</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.securityContext</code></td> <td>dict</td> <td>{}</td> <td>Container <a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-container">security settings</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.serviceAccount.create</code></td> <td>bool</td> <td>true</td> <td>Specifies whether a service account should be created</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.serviceAccount.annotations</code></td> <td>dict</td> <td>{}</td> <td>Annotations to add to the service account</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.serviceAccount.name</code></td> <td>string</td> <td> </td> <td>The name of the service account to use. If not set and create is true, a name is generated using the fullname template</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.rbac.create</code></td> <td>bool</td> <td>true</td> <td>Specifies whether to create <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">RBAC</a> configuration for nfd-master</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.resources.limits</code></td> <td>dict</td> <td>{memory: 4Gi}</td> <td>NFD master pod <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits">resources limits</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.resources.requests</code></td> <td>dict</td> <td>{cpu: 100m, memory: 128Mi}</td> <td>NFD master pod <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits">resources requests</a>. See <code class="language-plaintext highlighter-rouge">[0]</code> for more info</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.podDisruptionBudget.enable</code></td> <td>bool</td> <td>false</td> <td>Specifies whether to create a podDisruptionBudget configuration for nfd-master</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.podDisruptionBudget.minAvailable</code></td> <td>integer</td> <td>1</td> <td>Specifies minAvailable for the podDisruptionBudget configuration for nfd-master</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.podDisruptionBudget.maxUnavailable</code></td> <td>integer</td> <td>NULL</td> <td>Specifies maxUnavailable for the podDisruptionBudget configuration for nfd-master</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.podDisruptionBudget.unhealthyPodEvictionPolicy</code></td> <td>string</td> <td>AlwaysAllow</td> <td>Specifies unhealthyPodEvictionPolicy for the podDisruptionBudget configuration for nfd-master</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.tolerations</code></td> <td>dict</td> <td><em>Schedule to control-plane node</em></td> <td>NFD master pod <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/">tolerations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.annotations</code></td> <td>dict</td> <td>{}</td> <td>NFD master pod <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">annotations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.affinity</code></td> <td>dict</td> <td> </td> <td>NFD master pod required <a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes-using-node-affinity/">node affinity</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.deploymentAnnotations</code></td> <td>dict</td> <td>{}</td> <td>NFD master deployment <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">annotations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.nfdApiParallelism</code></td> <td>integer</td> <td>10</td> <td>Specifies the maximum number of concurrent node updates.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.config</code></td> <td>dict</td> <td> </td> <td>NFD master <a href="../reference/master-configuration-reference">configuration</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.extraArgs</code></td> <td>array</td> <td>[]</td> <td>Additional <a href="/node-feature-discovery/master/reference/master-commandline-reference.html">command line arguments</a> to pass to nfd-master</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.extraEnvs</code></td> <td>array</td> <td>[]</td> <td>Additional environment variables to pass to nfd-master</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.revisionHistoryLimit</code></td> <td>integer</td> <td> </td> <td>Specify how many old ReplicaSets for this Deployment you want to retain. <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#revision-history-limit">revisionHistoryLimit</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.startupProbe.initialDelaySecond s</code></td> <td>integer</td> <td>0 (by Kubernetes)</td> <td>Specifies the number of seconds after the container has started before startup probes are initiated.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.startupProbe.failureThreshold</code></td> <td>integer</td> <td>30</td> <td>Specifies the number of consecutive failures of startup probes before considering the pod as not ready.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.startupProbe.periodSeconds</code></td> <td>integer</td> <td>10 (by Kubernetes)</td> <td>Specifies how often (in seconds) to perform the startup probe.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.startupProbe.timeoutSeconds</code></td> <td>integer</td> <td>1 (by Kubernetes)</td> <td>Specifies the number of seconds after which the probe times out.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.livenessProbe.initialDelaySeconds</code></td> <td>integer</td> <td>0 (by Kubernetes)</td> <td>Specifies the number of seconds after the container has started before liveness probes are initiated.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.livenessProbe.failureThreshold</code></td> <td>integer</td> <td>3 (by Kubernetes)</td> <td>Specifies the number of consecutive failures of liveness probes before considering the pod as not ready.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.livenessProbe.periodSeconds</code></td> <td>integer</td> <td>10 (by Kubernetes)</td> <td>Specifies how often (in seconds) to perform the liveness probe.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.livenessProbe.timeoutSeconds</code></td> <td>integer</td> <td>1 (by Kubernetes)</td> <td>Specifies the number of seconds after which the probe times out.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.readinessProbe.initialDelaySeconds</code></td> <td>integer</td> <td>0 (by Kubernetes)</td> <td>Specifies the number of seconds after the container has started before readiness probes are initiated.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.readinessProbe.failureThreshold</code></td> <td>integer</td> <td>10</td> <td>Specifies the number of consecutive failures of readiness probes before considering the pod as not ready.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.readinessProbe.periodSeconds</code></td> <td>integer</td> <td>10 (by Kubernetes)</td> <td>Specifies how often (in seconds) to perform the readiness probe.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.readinessProbe.timeoutSeconds</code></td> <td>integer</td> <td>1 (by Kubernetes)</td> <td>Specifies the number of seconds after which the probe times out.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.readinessProbe.successThreshold</code></td> <td>integer</td> <td>1 (by Kubernetes)</td> <td>Specifies the number of consecutive successes of readiness probes before considering the pod as ready.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">master.dnsPolicy</code></td> <td>array</td> <td>ClusterFirstWithHostNet</td> <td>NFD master pod <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#pod-s-dns-policy">dnsPolicy</a></td> </tr> </tbody> </table></div> <blockquote> <p><code class="language-plaintext highlighter-rouge">[0]</code> Additional info for <code class="language-plaintext highlighter-rouge">master.resources.requests</code>: <br /> You may want to use the same value for <code class="language-plaintext highlighter-rouge">requests.memory</code> and <code class="language-plaintext highlighter-rouge">limits.memory</code>. The “requests” value affects scheduling to accommodate pods on nodes. If there is a large difference between “requests” and “limits” and nodes experience memory pressure, the kernel may invoke the OOM Killer, even if the memory does not exceed the “limits” threshold. This can cause unexpected pod evictions. Memory cannot be compressed and once allocated to a pod, it can only be reclaimed by killing the pod. <a href="https://home.robusta.dev/blog/kubernetes-memory-limit">Natan Yellin 22/09/2022</a> that discusses this issue.</p> </blockquote> <h3 id="worker-pod-parameters"> <a href="#worker-pod-parameters" class="anchor-heading" aria-labelledby="worker-pod-parameters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Worker pod parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">worker.*</code></td> <td>dict</td> <td> </td> <td>NFD worker daemonset configuration</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.enable</code></td> <td>bool</td> <td>true</td> <td>Specifies whether nfd-worker should be deployed</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.hostNetwork</code></td> <td>bool</td> <td>false</td> <td>Specifies whether to enable or disable running the container in the host’s network namespace</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.port</code></td> <td>int</td> <td>8080</td> <td>Port on which to serve http for metrics and healthz endpoints.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.config</code></td> <td>dict</td> <td> </td> <td>NFD worker <a href="../reference/worker-configuration-reference">configuration</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.podSecurityContext</code></td> <td>dict</td> <td>{}</td> <td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod">PodSecurityContext</a> holds pod-level security attributes and common container settins</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.securityContext</code></td> <td>dict</td> <td>{}</td> <td>Container <a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-container">security settings</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.serviceAccount.create</code></td> <td>bool</td> <td>true</td> <td>Specifies whether a service account for nfd-worker should be created</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.serviceAccount.annotations</code></td> <td>dict</td> <td>{}</td> <td>Annotations to add to the service account for nfd-worker</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.serviceAccount.name</code></td> <td>string</td> <td> </td> <td>The name of the service account to use for nfd-worker. If not set and create is true, a name is generated using the fullname template (suffixed with <code class="language-plaintext highlighter-rouge">-worker</code>)</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.rbac.create</code></td> <td>bool</td> <td>true</td> <td>Specifies whether to create <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">RBAC</a> configuration for nfd-worker</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.mountUsrSrc</code></td> <td>bool</td> <td>false</td> <td>Specifies whether to allow users to mount the hostpath /user/src. Does not work on systems without /usr/src AND a read-only /usr</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.resources.limits</code></td> <td>dict</td> <td>{memory: 512Mi}</td> <td>NFD worker pod <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits">resources limits</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.resources.requests</code></td> <td>dict</td> <td>{cpu: 5m, memory: 64Mi}</td> <td>NFD worker pod <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits">resources requests</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.nodeSelector</code></td> <td>dict</td> <td>{}</td> <td>NFD worker pod <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector">node selector</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.tolerations</code></td> <td>dict</td> <td>{}</td> <td>NFD worker pod <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/">node tolerations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.priorityClassName</code></td> <td>string</td> <td> </td> <td>NFD worker pod <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/pod-priority-preemption/">priority class</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.annotations</code></td> <td>dict</td> <td>{}</td> <td>NFD worker pod <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">annotations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.daemonsetAnnotations</code></td> <td>dict</td> <td>{}</td> <td>NFD worker daemonset <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">annotations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.extraArgs</code></td> <td>array</td> <td>[]</td> <td>Additional <a href="/node-feature-discovery/master/reference/worker-commandline-reference.html">command line arguments</a> to pass to nfd-worker</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.extraEnvs</code></td> <td>array</td> <td>[]</td> <td>Additional environment variables to pass to nfd-worker</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.revisionHistoryLimit</code></td> <td>integer</td> <td> </td> <td>Specify how many old ControllerRevisions for this DaemonSet you want to retain. <a href="https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/daemon-set-v1/ #DaemonSetSpec">revisionHistoryLimit</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.livenessProbe.initialDelaySeconds</code></td> <td>integer</td> <td>10</td> <td>Specifies the number of seconds after the container has started before liveness probes are initiated.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.livenessProbe.failureThreshold</code></td> <td>integer</td> <td>3 (by Kubernetes)</td> <td>Specifies the number of consecutive failures of liveness probes before considering the pod as not ready.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.livenessProbe.periodSeconds</code></td> <td>integer</td> <td>10 (by Kubernetes)</td> <td>Specifies how often (in seconds) to perform the liveness probe.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.livenessProbe.timeoutSeconds</code></td> <td>integer</td> <td>1 (by Kubernetes)</td> <td>Specifies the number of seconds after which the probe times out.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.readinessProbe.initialDelaySeconds</code></td> <td>integer</td> <td>5</td> <td>Specifies the number of seconds after the container has started before readiness probes are initiated.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.readinessProbe.failureThreshold</code></td> <td>integer</td> <td>10</td> <td>Specifies the number of consecutive failures of readiness probes before considering the pod as not ready.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.readinessProbe.periodSeconds</code></td> <td>integer</td> <td>10 (by Kubernetes)</td> <td>Specifies how often (in seconds) to perform the readiness probe.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.readinessProbe.timeoutSeconds</code></td> <td>integer</td> <td>1 (by Kubernetes)</td> <td>Specifies the number of seconds after which the probe times out.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.readinessProbe.successThreshold</code></td> <td>integer</td> <td>1 (by Kubernetes)</td> <td>Specifies the number of consecutive successes of readiness probes before considering the pod as ready.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.dnsPolicy</code></td> <td>array</td> <td>ClusterFirstWithHostNet</td> <td>NFD worker pod <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#pod-s-dns-policy">dnsPolicy</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">worker.updateStrategy</code></td> <td>dict</td> <td>{}</td> <td>Daemonset <a href="https://kubernetes.io/docs/tasks/manage-daemon/update-daemon-set/#performing-a-rolling-update">updateStrategy</a></td> </tr> </tbody> </table></div> <h3 id="topology-updater-parameters"> <a href="#topology-updater-parameters" class="anchor-heading" aria-labelledby="topology-updater-parameters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Topology updater parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.*</code></td> <td>dict</td> <td> </td> <td>NFD Topology Updater configuration</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.enable</code></td> <td>bool</td> <td>false</td> <td>Specifies whether the NFD Topology Updater should be created</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.hostNetwork</code></td> <td>bool</td> <td>false</td> <td>Specifies whether to enable or disable running the container in the host’s network namespace</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.createCRDs</code></td> <td>bool</td> <td>false</td> <td>Specifies whether the NFD Topology Updater CRDs should be created</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.serviceAccount.create</code></td> <td>bool</td> <td>true</td> <td>Specifies whether the service account for topology updater should be created</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.serviceAccount.annotations</code></td> <td>dict</td> <td>{}</td> <td>Annotations to add to the service account for topology updater</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.serviceAccount.name</code></td> <td>string</td> <td> </td> <td>The name of the service account for topology updater to use. If not set and create is true, a name is generated using the fullname template and <code class="language-plaintext highlighter-rouge">-topology-updater</code> suffix</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.rbac.create</code></td> <td>bool</td> <td>true</td> <td>Specifies whether to create <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">RBAC</a> configuration for topology updater</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.port</code></td> <td>integer</td> <td>8080</td> <td>Port on which to serve http for metrics and healthz endpoints.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.kubeletConfigPath</code></td> <td>string</td> <td>””</td> <td>Specifies the kubelet config host path</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.kubeletPodResourcesSockPath</code></td> <td>string</td> <td>””</td> <td>Specifies the kubelet sock path to read pod resources</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.updateInterval</code></td> <td>string</td> <td>60s</td> <td>Time to sleep between CR updates. Non-positive value implies no CR update.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.watchNamespace</code></td> <td>string</td> <td><code class="language-plaintext highlighter-rouge">*</code></td> <td>Namespace to watch pods, <code class="language-plaintext highlighter-rouge">*</code> for all namespaces</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.podSecurityContext</code></td> <td>dict</td> <td>{}</td> <td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod">PodSecurityContext</a> holds pod-level security attributes and common container sett</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.securityContext</code></td> <td>dict</td> <td>{}</td> <td>Container <a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-container">security settings</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.resources.limits</code></td> <td>dict</td> <td>{memory: 60Mi}</td> <td>NFD Topology Updater pod <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits">resources limits</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.resources.requests</code></td> <td>dict</td> <td>{cpu: 50m, memory: 40Mi}</td> <td>NFD Topology Updater pod <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits">resources requests</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.nodeSelector</code></td> <td>dict</td> <td>{}</td> <td>Topology updater pod <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector">node selector</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.tolerations</code></td> <td>dict</td> <td>{}</td> <td>Topology updater pod <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/">node tolerations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.annotations</code></td> <td>dict</td> <td>{}</td> <td>Topology updater pod <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">annotations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.daemonsetAnnotations</code></td> <td>dict</td> <td>{}</td> <td>Topology updater daemonset <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">annotations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.affinity</code></td> <td>dict</td> <td>{}</td> <td>Topology updater pod <a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes-using-node-affinity/">affinity</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.config</code></td> <td>dict</td> <td> </td> <td><a href="../reference/topology-updater-configuration-reference">configuration</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.podSetFingerprint</code></td> <td>bool</td> <td>true</td> <td>Enables compute and report of pod fingerprint in NRT objects.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.kubeletStateDir</code></td> <td>string</td> <td>/var/lib/kubelet</td> <td>Specifies kubelet state directory path for watching state and checkpoint files. Empty value disables kubelet state tracking.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.extraArgs</code></td> <td>array</td> <td>[]</td> <td>Additional <a href="/node-feature-discovery/master/reference/topology-updater-commandline-reference.html">command line arguments</a> to pass to nfd-topology-updater</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.extraEnvs</code></td> <td>array</td> <td>[]</td> <td>Additional environment variables to pass to nfd-topology-updater</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.revisionHistoryLimit</code></td> <td>integer</td> <td> </td> <td>Specify how many old ControllerRevisions for this DaemonSet you want to retain. <a href="https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/daemon-set-v1/#DaemonSetSpec">revisionHistoryLimit</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.livenessProbe.initialDelaySeconds</code></td> <td>integer</td> <td>10</td> <td>Specifies the number of seconds after the container has started before liveness probes are initiated.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.livenessProbe.failureThreshold</code></td> <td>integer</td> <td>3 (by Kubernetes)</td> <td>Specifies the number of consecutive failures of liveness probes before considering the pod as not ready.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.livenessProbe.periodSeconds</code></td> <td>integer</td> <td>10 (by Kubernetes)</td> <td>Specifies how often (in seconds) to perform the liveness probe.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.livenessProbe.timeoutSeconds</code></td> <td>integer</td> <td>1 (by Kubernetes)</td> <td>Specifies the number of seconds after which the probe times out.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.readinessProbe.initialDelaySeconds</code></td> <td>integer</td> <td>5</td> <td>Specifies the number of seconds after the container has started before readiness probes are initiated.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.readinessProbe.failureThreshold</code></td> <td>integer</td> <td>10</td> <td>Specifies the number of consecutive failures of readiness probes before considering the pod as not ready.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.readinessProbe.periodSeconds</code></td> <td>integer</td> <td>10 (by Kubernetes)</td> <td>Specifies how often (in seconds) to perform the readiness probe.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.readinessProbe.timeoutSeconds</code></td> <td>integer</td> <td>1 (by Kubernetes)</td> <td>Specifies the number of seconds after which the probe times out.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.readinessProbe.successThreshold</code></td> <td>integer</td> <td>1 (by Kubernetes)</td> <td>Specifies the number of consecutive successes of readiness probes before considering the pod as ready.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">topologyUpdater.dnsPolicy</code></td> <td>array</td> <td>ClusterFirstWithHostNet</td> <td>Topology updater pod <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#pod-s-dns-policy">dnsPolicy</a></td> </tr> </tbody> </table></div> <h3 id="garbage-collector-parameters"> <a href="#garbage-collector-parameters" class="anchor-heading" aria-labelledby="garbage-collector-parameters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Garbage collector parameters </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">gc.*</code></td> <td>dict</td> <td> </td> <td>NFD Garbage Collector configuration</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.enable</code></td> <td>bool</td> <td>true</td> <td>Specifies whether the NFD Garbage Collector should be created</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.hostNetwork</code></td> <td>bool</td> <td>false</td> <td>Specifies whether to enable or disable running the container in the host’s network namespace</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.serviceAccount.create</code></td> <td>bool</td> <td>true</td> <td>Specifies whether the service account for garbage collector should be created</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.serviceAccount.annotations</code></td> <td>dict</td> <td>{}</td> <td>Annotations to add to the service account for garbage collector</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.serviceAccount.name</code></td> <td>string</td> <td> </td> <td>The name of the service account for garbage collector to use. If not set and create is true, a name is generated using the fullname template and <code class="language-plaintext highlighter-rouge">-gc</code> suffix</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.rbac.create</code></td> <td>bool</td> <td>true</td> <td>Specifies whether to create <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">RBAC</a> configuration for garbage collector</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.interval</code></td> <td>string</td> <td>1h</td> <td>Time between periodic garbage collector runs</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.podSecurityContext</code></td> <td>dict</td> <td>{}</td> <td><a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod">PodSecurityContext</a> holds pod-level security attributes and common container settings</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.resources.limits</code></td> <td>dict</td> <td>{memory: 1Gi}</td> <td>NFD Garbage Collector pod <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits">resources limits</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.resources.requests</code></td> <td>dict</td> <td>{cpu: 10m, memory: 128Mi}</td> <td>NFD Garbage Collector pod <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#requests-and-limits">resources requests</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.podDisruptionBudget.enable</code></td> <td>bool</td> <td>false</td> <td>Specifies whether to create a podDisruptionBudget configuration for nfd-gc</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.podDisruptionBudget.minAvailable</code></td> <td>integer</td> <td>1</td> <td>Specifies minAvailable for the podDisruptionBudget configuration for nfd-gc</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.podDisruptionBudget.maxUnavailable</code></td> <td>integer</td> <td>NULL</td> <td>Specifies maxUnavailable for the podDisruptionBudget configuration for nfd-gc</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.podDisruptionBudget.unhealthyPodEvictionPolicy</code></td> <td>string</td> <td>AlwaysAllow</td> <td>Specifies unhealthyPodEvictionPolicy for the podDisruptionBudget configuration for nfd-gc</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.metricsPort</code></td> <td>integer</td> <td>8081</td> <td>Port on which to serve Prometheus metrics. <strong>DEPRECATED</strong>: will be replaced by <code class="language-plaintext highlighter-rouge">gc.port</code> in NFD v0.18.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.nodeSelector</code></td> <td>dict</td> <td>{}</td> <td>Garbage collector pod <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector">node selector</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.tolerations</code></td> <td>dict</td> <td>{}</td> <td>Garbage collector pod <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/">node tolerations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.annotations</code></td> <td>dict</td> <td>{}</td> <td>Garbage collector pod <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">annotations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.deploymentAnnotations</code></td> <td>dict</td> <td>{}</td> <td>Garbage collector deployment <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">annotations</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.affinity</code></td> <td>dict</td> <td>{}</td> <td>Garbage collector pod <a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes-using-node-affinity/">affinity</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.extraArgs</code></td> <td>array</td> <td>[]</td> <td>Additional <a href="/node-feature-discovery/master/reference/gc-commandline-reference.html">command line arguments</a> to pass to nfd-gc</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.extraEnvs</code></td> <td>array</td> <td>[]</td> <td>Additional environment variables to pass to nfd-gc</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.revisionHistoryLimit</code></td> <td>integer</td> <td> </td> <td>Specify how many old ReplicaSets for this Deployment you want to retain. <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#revision-history-limit">revisionHistoryLimit</a></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">gc.dnsPolicy</code></td> <td>array</td> <td>ClusterFirstWithHostNet</td> <td>Garbage collector pod <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#pod-s-dns-policy">dnsPolicy</a></td> </tr> </tbody> </table></div> <!-- Links --> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
